{
  "id": "be4cf4b3-7e14-4d53-b6f9-966ba0867163",
  "prevId": "8274639f-5810-4b03-9791-1aecc89e1e56",
  "version": "7",
  "dialect": "postgresql",
  "tables": {
    "public.agent_memory": {
      "name": "agent_memory",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "agent_id": {
          "name": "agent_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "memory_key": {
          "name": "memory_key",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "data": {
          "name": "data",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true
        },
        "expires_at": {
          "name": "expires_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "agent_memory_agent_key_idx": {
          "name": "agent_memory_agent_key_idx",
          "columns": [
            {
              "expression": "agent_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "memory_key",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "agent_memory_agent_id_idx": {
          "name": "agent_memory_agent_id_idx",
          "columns": [
            {
              "expression": "agent_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "agent_memory_expires_at_idx": {
          "name": "agent_memory_expires_at_idx",
          "columns": [
            {
              "expression": "expires_at",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.connections": {
      "name": "connections",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "org_id": {
          "name": "org_id",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": true
        },
        "user_id": {
          "name": "user_id",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": true
        },
        "provider_id": {
          "name": "provider_id",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": true
        },
        "external_account_metadata": {
          "name": "external_account_metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'::jsonb"
        },
        "capabilities": {
          "name": "capabilities",
          "type": "text[]",
          "primaryKey": false,
          "notNull": true
        },
        "status": {
          "name": "status",
          "type": "connection_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'active'"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_connections_org_id_user_id_provider_id_active": {
          "name": "idx_connections_org_id_user_id_provider_id_active",
          "columns": [
            {
              "expression": "org_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "user_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "provider_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "where": "\"connections\".\"status\" = $1",
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.document_store": {
      "name": "document_store",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "org_id": {
          "name": "org_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "document_id": {
          "name": "document_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "document_type": {
          "name": "document_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "document_uri": {
          "name": "document_uri",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "title": {
          "name": "title",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "mime_type": {
          "name": "mime_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "size_bytes": {
          "name": "size_bytes",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "uploader_user_id": {
          "name": "uploader_user_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "ownership_scope": {
          "name": "ownership_scope",
          "type": "ownership_scope",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'organization'"
        },
        "owner_id": {
          "name": "owner_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "status": {
          "name": "status",
          "type": "document_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'registered'"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.document_tags": {
      "name": "document_tags",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "org_id": {
          "name": "org_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "document_id": {
          "name": "document_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "tag_id": {
          "name": "tag_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "uniq_document_tag": {
          "name": "uniq_document_tag",
          "columns": [
            {
              "expression": "org_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "document_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "tag_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_document_tags_org_tag": {
          "name": "idx_document_tags_org_tag",
          "columns": [
            {
              "expression": "org_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "tag_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_document_tags_org_doc": {
          "name": "idx_document_tags_org_doc",
          "columns": [
            {
              "expression": "org_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "document_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "document_tags_document_id_document_store_id_fk": {
          "name": "document_tags_document_id_document_store_id_fk",
          "tableFrom": "document_tags",
          "tableTo": "document_store",
          "columnsFrom": ["document_id"],
          "columnsTo": ["id"],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "document_tags_tag_id_tags_id_fk": {
          "name": "document_tags_tag_id_tags_id_fk",
          "tableFrom": "document_tags",
          "tableTo": "tags",
          "columnsFrom": ["tag_id"],
          "columnsTo": ["id"],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.knowledge_snippets": {
      "name": "knowledge_snippets",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "org_id": {
          "name": "org_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "source_run_id": {
          "name": "source_run_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "origin": {
          "name": "origin",
          "type": "knowledge_snippet_origin",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'agent'"
        },
        "summary": {
          "name": "summary",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "blob": {
          "name": "blob",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "embedding": {
          "name": "embedding",
          "type": "vector(1536)",
          "primaryKey": false,
          "notNull": true
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'::jsonb"
        },
        "ownership_scope": {
          "name": "ownership_scope",
          "type": "ownership_scope",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": false,
          "default": "'organization'"
        },
        "owner_id": {
          "name": "owner_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "document_id": {
          "name": "document_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "chunk_index": {
          "name": "chunk_index",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "chunk_count": {
          "name": "chunk_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "checksum": {
          "name": "checksum",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_knowledge_snippets_org_id_source_run_id": {
          "name": "idx_knowledge_snippets_org_id_source_run_id",
          "columns": [
            {
              "expression": "org_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "source_run_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "embeddingIndex": {
          "name": "embeddingIndex",
          "columns": [
            {
              "expression": "embedding",
              "isExpression": false,
              "asc": true,
              "nulls": "last",
              "opclass": "vector_cosine_ops"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "hnsw",
          "with": {}
        },
        "idx_knowledge_snippets_org_id_document_id": {
          "name": "idx_knowledge_snippets_org_id_document_id",
          "columns": [
            {
              "expression": "org_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "document_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "uniq_knowledge_snippets_document_chunk": {
          "name": "uniq_knowledge_snippets_document_chunk",
          "columns": [
            {
              "expression": "document_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "chunk_index",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "uniq_knowledge_snippets_document_checksum": {
          "name": "uniq_knowledge_snippets_document_checksum",
          "columns": [
            {
              "expression": "document_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "checksum",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.oauth_transactions": {
      "name": "oauth_transactions",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "user_id": {
          "name": "user_id",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": true
        },
        "org_id": {
          "name": "org_id",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": true
        },
        "provider": {
          "name": "provider",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": true
        },
        "capabilities": {
          "name": "capabilities",
          "type": "text[]",
          "primaryKey": false,
          "notNull": true
        },
        "requested_scopes": {
          "name": "requested_scopes",
          "type": "text[]",
          "primaryKey": false,
          "notNull": true
        },
        "state": {
          "name": "state",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": true
        },
        "code_verifier": {
          "name": "code_verifier",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "redirect_uri": {
          "name": "redirect_uri",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "status": {
          "name": "status",
          "type": "oauth_transaction_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'pending'"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "expires_at": {
          "name": "expires_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "finished_at": {
          "name": "finished_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.tags": {
      "name": "tags",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "org_id": {
          "name": "org_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "uniq_tags_org_name": {
          "name": "uniq_tags_org_name",
          "columns": [
            {
              "expression": "org_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "name",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": true,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_tags_org_id": {
          "name": "idx_tags_org_id",
          "columns": [
            {
              "expression": "org_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.tokens": {
      "name": "tokens",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "connection_id": {
          "name": "connection_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "ownership_scope": {
          "name": "ownership_scope",
          "type": "ownership_scope",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "owner_id": {
          "name": "owner_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "token_payload": {
          "name": "token_payload",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true
        },
        "scopes": {
          "name": "scopes",
          "type": "text[]",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "tokens_connection_id_connections_id_fk": {
          "name": "tokens_connection_id_connections_id_fk",
          "tableFrom": "tokens",
          "tableTo": "connections",
          "columnsFrom": ["connection_id"],
          "columnsTo": ["id"],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "unique_token_per_scope": {
          "name": "unique_token_per_scope",
          "nullsNotDistinct": false,
          "columns": ["connection_id", "ownership_scope", "owner_id"]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.trigger_registrations": {
      "name": "trigger_registrations",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "org_id": {
          "name": "org_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "agent_id": {
          "name": "agent_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "provider_id": {
          "name": "provider_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "connection_id": {
          "name": "connection_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "trigger_id": {
          "name": "trigger_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "params": {
          "name": "params",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'::jsonb"
        },
        "subscription_metadata": {
          "name": "subscription_metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'::jsonb"
        },
        "expires_at": {
          "name": "expires_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "trigger_registrations_connection_id_connections_id_fk": {
          "name": "trigger_registrations_connection_id_connections_id_fk",
          "tableFrom": "trigger_registrations",
          "tableTo": "connections",
          "columnsFrom": ["connection_id"],
          "columnsTo": ["id"],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    }
  },
  "enums": {
    "public.connection_status": {
      "name": "connection_status",
      "schema": "public",
      "values": ["active", "inactive", "error"]
    },
    "public.document_status": {
      "name": "document_status",
      "schema": "public",
      "values": ["registered", "uploaded", "processing", "completed", "failed"]
    },
    "public.knowledge_snippet_origin": {
      "name": "knowledge_snippet_origin",
      "schema": "public",
      "values": ["agent", "user_upload"]
    },
    "public.oauth_transaction_status": {
      "name": "oauth_transaction_status",
      "schema": "public",
      "values": ["pending", "completed", "failed", "expired"]
    },
    "public.ownership_scope": {
      "name": "ownership_scope",
      "schema": "public",
      "values": ["user", "organization"]
    }
  },
  "schemas": {},
  "sequences": {},
  "roles": {},
  "policies": {},
  "views": {},
  "_meta": {
    "columns": {},
    "schemas": {},
    "tables": {}
  }
}
